INTRODUCTION

This is an Android input method which displays a virtual on screen
Braille keyboard for use by a blind person. This facilitates much
faster and more comfortable input for the blind on Android with a
variety of powerful editing commands and support for a number of
different languages.

Please see https://goo.gl/lD1v49 for more details on the project.

If you are interested in becoming involved with any development or have questions please
contact Daniel Dalton <daniel.dalton10@gmail.com>

Please see the TODO file in this directory for a list of things that
need attention.

This application is licensed under the Apache License, Version 2.0 (the "License");
You may obtain a copy of the License at
http://www.apache.org/licenses/LICENSE-2.0

BUILDING THE APP

The project has been migrated to Gradle and supports building with modern Android development tools.

Prerequisites:
*   **JDK 21:** The build is configured to use Java 21 (e.g., OpenJDK 21 or Android Studio JBR).
*   **Android SDK & NDK:** Ensure you have the Android SDK installed.
    *   **Important:** If your user path contains spaces (e.g., `C:\Users\AMAIS 10`), you MUST use the short path (8.3 format, e.g., `C:\Users\AMAIS1~1`) in your `local.properties` file for the `sdk.dir` property. This prevents build failures in the NDK components (liblouis/brltty).

Setup:
1.  **Clone the repository:**
    ```bash
    git clone <repository-url>
    cd Soft-Braille-Keyboard
    ```

2.  **Configure SDK Location:**
    Create a `local.properties` file in the root directory if it doesn't exist (it is automatically created if you open the project in Android Studio).
    Example content for Windows (using forward slashes):
    ```properties
    sdk.dir=C:/Users/YOURUS~1/AppData/Local/Android/Sdk
    ```

Build Commands:

*   **Debug Build:**
    To build the debug APK:
    ```bash
    .\gradlew.bat assembleDebug
    ```
    The APK will be located at: `build/outputs/apk/debug/Soft-Braille-Keyboard-debug.apk`

*   **Release Build:**
    To build the unsigned release APK:
    ```bash
    .\gradlew.bat assembleRelease
    ```
    The APK will be located at: `build/outputs/apk/release/Soft-Braille-Keyboard-release-unsigned.apk`

*   **Clean:**
    To clean the build artifacts:
    ```bash
    .\gradlew.bat clean
    ```

WAV FEEDBACK FEATURE

This app includes a high-performance audio feedback system that uses pre-generated WAV files instead of the system TTS engine for single character echoes. This significantly reduces latency.

*   **Activation:** Go to Keyboard Settings -> Keyboard Feedback -> Enable "Use WAV feedback".
*   **Mechanism:** When enabled, the app checks the `assets/sounds/` directory for a WAV file matching the typed character. If found, it plays via `SoundPool`; otherwise, it falls back to standard TTS.

ADDING SUPPORT FOR OTHER LANGUAGES

To add sounds for a new language (e.g., Russian, French):

1.  **Generate the WAV files:**
    *   Modify `scripts/generate_audio.py`.
    *   Update `VOICE_ARGS` to include the language flag (e.g., `-vru` for Russian).
    *   Update the `CHARS` dictionary with the characters and their pronunciation in the target language.
    *   Run the script: `python scripts/generate_audio.py`.

2.  **Update the Android logic:**
    *   The mapping between a character and a filename is handled in `src/com/dalton/braillekeyboard/Speech.java` in the `getSoundFilename(String text)` method.
    *   If the new language uses special characters (e.g., 'ñ', 'ч'), you must add them to the `switch` statement in that method to return the corresponding filename.

3.  **Filenames:**
    *   Lower case letters: `a.wav`, `b.wav`...
    *   Upper case letters: `a_cap.wav`, `b_cap.wav`... (The code automatically appends `_cap` for uppercase letters).
    *   Symbols: Use descriptive names (e.g., `dot.wav`, `comma.wav`).

Project Structure:
The project is a multi-module Gradle project:
*   `:` (Root) - The main application module (Soft Braille Keyboard).
*   `:client` - The BrailleBack client library (`brailleback/braille/client`).
*   `:service` - The BrailleBack service library (`brailleback/braille/service`).

ADDING A BRAILLE TABLE

- add the new table in the
  brailleback/braille/service/jni/liblouiswrapper/liblouis/tables/
  directory.
- Update brailleback/braille/service/res/xml/tables.xml.
- Run brailleback/braille/service/tables/mktranslationtables from the
  brailleback/braille/service dir.
- Update res/values/arrays.xml to also include the id of the newly
  defined table you created for the braille service.
- Clean build everything and test.